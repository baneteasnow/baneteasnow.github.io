{% for post in site.posts %}
  {% capture current_month %}{{ post.date | date: "%Y %B" }}{% endcapture %}
  {% if current_month != previous_month %}
    {% unless forloop.first %}
      </ul>
    {% endunless %}
    <h2>{{ current_month }}</h2>
    <ul>
    {% assign previous_month = current_month %}
  {% endif %}
  <li><a href="{{ post.url }}">{{ post.title }}</a></li>

  {% if forloop.last %}
    </ul>
  {% endif %}
{% endfor %}
...
